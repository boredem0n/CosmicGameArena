<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Timer Rental PS</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Menggunakan font Inter untuk teks umum dan Roboto Mono untuk timer */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* bg-gray-900 */
        }
        .timer-display, .timer-card h3 {
            font-family: 'Roboto Mono', monospace;
        }

        /* Animasi untuk timer yang sudah habis */
        .timer-expired {
            animation: pulse-bg 1.5s infinite;
        }

        @keyframes pulse-bg {
            0% {
                background-color: #991b1b; /* red-800 */
                transform: scale(1);
            }
            50% {
                background-color: #b91c1c; /* red-700 */
                transform: scale(1.02);
            }
            100% {
                background-color: #991b1b; /* red-800 */
                transform: scale(1);
            }
        }
    </style>
</head>
<body class="bg-gray-900 text-white p-4 sm:p-6 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Judul Halaman -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-cyan-400 tracking-wider">ðŸŽ® COSMIC GAME ARENA</h1>
        </header>

        <!-- Form untuk Menambah Timer Baru -->
        <div class="max-w-lg mx-auto bg-gray-800 p-6 rounded-2xl shadow-lg mb-10 border border-gray-700">
            <form id="add-timer-form" class="space-y-4">
                <div>
                    <label for="timer-name" class="block mb-2 text-sm font-medium text-gray-300">Nama / Nomor TV</label>
                    <input type="text" id="timer-name" placeholder="Contoh: PS5 TV 01" required
                           class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-cyan-500 focus:border-cyan-500 transition">
                </div>
                <div>
                    <label for="timer-duration" class="block mb-2 text-sm font-medium text-gray-300">Durasi (menit)</label>
                    <input type="number" id="timer-duration" placeholder="Contoh: 60" required min="1"
                           class="w-full bg-gray-700 border border-gray-600 text-white rounded-lg p-3 focus:ring-cyan-500 focus:border-cyan-500 transition">
                </div>
                <button type="submit"
                        class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 px-4 rounded-lg transition-transform transform hover:scale-105 active:scale-100 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-opacity-50">
                    Mulai Timer Baru
                </button>
            </form>
        </div>

        <!-- Kontainer untuk semua kartu timer -->
        <div id="timers-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <!-- Kartu timer akan ditambahkan di sini oleh JavaScript -->
        </div>

    </div>

    <!-- Elemen audio untuk suara alarm, disembunyikan -->
    <audio id="alarm-sound" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg" preload="auto"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('add-timer-form');
            const timersContainer = document.getElementById('timers-container');
            const alarmSound = document.getElementById('alarm-sound');
            let timers = []; // Array untuk menyimpan data dan interval setiap timer

            // Fungsi untuk membuat kartu timer baru
            const addTimerCard = (name, durationInMinutes) => {
                const id = `timer-${Date.now()}`;
                const endTime = Date.now() + durationInMinutes * 60 * 1000;

                const card = document.createElement('div');
                card.id = id;
                card.className = "timer-card bg-gray-800 p-5 rounded-2xl shadow-lg border border-gray-700 flex flex-col transition-all duration-300";
                card.dataset.endTime = endTime;
                card.dataset.state = 'running'; // State awal: running, paused

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-lg font-bold text-cyan-400 break-all pr-2">${name}</h3>
                        <button class="delete-btn text-gray-500 hover:text-red-500 text-2xl leading-none">&times;</button>
                    </div>
                    <div class="timer-display text-5xl font-bold text-center my-2 text-white">00:00:00</div>
                    <div class="flex justify-center mb-3">
                        <button class="pause-resume-btn bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-bold py-2 px-5 rounded-lg transition-transform transform hover:scale-105">Pause</button>
                    </div>
                    <div class="end-time-text text-xs text-gray-400 text-center mt-auto">
                        Berakhir pada: ${new Date(endTime).toLocaleTimeString('id-ID')}
                    </div>
                `;

                timersContainer.appendChild(card);
                
                // Tambahkan event listener untuk tombol hapus
                card.querySelector('.delete-btn').addEventListener('click', () => {
                    const timerObj = timers.find(t => t.id === id);
                    if (timerObj) {
                        clearInterval(timerObj.interval);
                        timers = timers.filter(t => t.id !== id);
                    }
                    card.remove();
                });

                // Tambahkan event listener untuk tombol pause/resume
                const pauseResumeBtn = card.querySelector('.pause-resume-btn');
                pauseResumeBtn.addEventListener('click', () => togglePause(id));

                const interval = setInterval(() => updateTimer(id), 1000);
                timers.push({ id, interval });
                updateTimer(id);
            };

            const togglePause = (id) => {
                const card = document.getElementById(id);
                const timerObj = timers.find(t => t.id === id);
                if (!card || !timerObj) return;

                const pauseResumeBtn = card.querySelector('.pause-resume-btn');
                const state = card.dataset.state;

                if (state === 'running') {
                    // PAUSE ACTION
                    clearInterval(timerObj.interval);
                    card.dataset.remainingOnPause = Number(card.dataset.endTime) - Date.now();
                    card.dataset.state = 'paused';
                    
                    pauseResumeBtn.textContent = 'Lanjutkan';
                    pauseResumeBtn.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');
                    pauseResumeBtn.classList.add('bg-green-500', 'hover:bg-green-600');
                    card.classList.add('opacity-75');

                } else if (state === 'paused') {
                    // RESUME ACTION
                    const newEndTime = Date.now() + Number(card.dataset.remainingOnPause);
                    card.dataset.endTime = newEndTime;
                    card.dataset.state = 'running';
                    
                    card.querySelector('.end-time-text').textContent = `Berakhir pada: ${new Date(newEndTime).toLocaleTimeString('id-ID')}`;
                    timerObj.interval = setInterval(() => updateTimer(id), 1000);
                    
                    pauseResumeBtn.textContent = 'Pause';
                    pauseResumeBtn.classList.remove('bg-green-500', 'hover:bg-green-600');
                    pauseResumeBtn.classList.add('bg-yellow-500', 'hover:bg-yellow-600');
                    card.classList.remove('opacity-75');
                    updateTimer(id);
                }
            };
            
            // Fungsi untuk memperbarui tampilan waktu pada kartu timer
            const updateTimer = (id) => {
                const card = document.getElementById(id);
                if (!card || card.dataset.state === 'paused') return;

                const timeDisplay = card.querySelector('.timer-display');
                const endTime = Number(card.dataset.endTime);
                const remainingTime = endTime - Date.now();

                if (remainingTime > 0) {
                    const hours = Math.floor((remainingTime / (1000 * 60 * 60)) % 24);
                    const minutes = Math.floor((remainingTime / 1000 / 60) % 60);
                    const seconds = Math.floor((remainingTime / 1000) % 60);

                    timeDisplay.textContent = 
                        `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
                } else {
                    timeDisplay.textContent = 'HABIS!';
                    if (!card.classList.contains('timer-expired')) {
                        card.classList.add('timer-expired');
                        card.querySelector('.pause-resume-btn').style.display = 'none'; // Sembunyikan tombol pause jika sudah habis
                        playAlarm();
                    }
                    
                    const timerObj = timers.find(t => t.id === id);
                    if (timerObj) clearInterval(timerObj.interval);
                }
            };

            const playAlarm = () => {
                alarmSound.currentTime = 0;
                alarmSound.play().catch(error => {
                    console.warn("Gagal memutar audio secara otomatis:", error);
                });
            };

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                const nameInput = document.getElementById('timer-name');
                const durationInput = document.getElementById('timer-duration');

                const name = nameInput.value.trim();
                const duration = parseInt(durationInput.value, 10);

                if (name && duration > 0) {
                    addTimerCard(name, duration);
                    nameInput.value = '';
                    durationInput.value = '';
                    nameInput.focus();
                } else {
                    alert('Harap isi Nama dan Durasi dengan benar.');
                }
            });
        });
    </script>

</body>
</html>

